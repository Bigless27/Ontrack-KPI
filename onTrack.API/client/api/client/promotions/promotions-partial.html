<div class = 'container'>
	<div class = 'row'>
		<div class = 'col-md-8 col-md-offset-2'>
			<h1>Promotion</h1>
			<table class = 'table table-striped'>
					<tr>
						<th>Name</th>
						<td>
							<span 
								editable-text = "promotion.name" 
								e-form = 'name' 
								onbeforesave = 'updateName($data)'> 
								{{promotion.name}}
							</span>
						</td>
						<td>
							<a href="" ng-click="name.$show()" ng-hide="name.$visible">Edit</a>
						</td>
					</tr>
					<tr>
						<th>Type</th>
						<td>
							<span 
								id = 'promotion-type-edit'  
								style = 'color:black; border: none;'
								editable-select="promotion.type" 
								e-ng-options="s for s in typeList" onbeforesave = 'updateType($data)'
							>
								{{promotion.type || 'empty'}}
							</span>
						</td>
						<td>
							<a style = 'cursor: pointer;' class = 'promotion-edit-type-button'>
								Edit
							</a>
						</td>
					</tr>
					<tr>
						<th>Subtypes</th>
						<td>
							<span ng-show = '!subTags'>
								<ul ng-show = '!noSubtypes' ng-repeat = 'sub in promotion.subTypes'>
									<li>
										{{sub.name}}
									</li>
								</ul>
								<span ng-show = 'noSubtypes' class ='label label-danger'>Empty!</span>
							</span>
							<span ng-show = 'subTags' style = 'width: 200px;'>
								<multiple-autocomplete 
									ng-model="promotion.subTypes"
				     				object-property = "name"
				     				suggestions-arr= "subTypes"
				     				after-remove-item='afterRemoveItem'
				     				>
								</multiple-autocomplete>
								<span class = 'btn btn-info' ng-click = 'updateSubtypes(promotion.subTypes)'><i class = 'glyphicon glyphicon-ok' aria-hidden = 'true'></i></span>
								<span class = 'btn btn-danger' ng-click= 'toggleEdit()'><i class = 'glyphicon glyphicon-remove'></i></span>
							</span>
						</td>
						<td>
							<a ng-click = 'toggleEdit()' ng-show = '!subTags'>
							Edit
							</a>
						</td>
					</tr>
					<tr>
						<th>Completion Value</th>
						<td>
							<span 
								editable-text = "promotion.completionValue" 
								e-form = 'completionValue' 
								onbeforesave = 'updateCompletionValue($data)'> 
								{{promotion.completionValue}}
							</span>
						</td>
						<td>
							<a href="" ng-click="completionValue.$show()" ng-hide="completionValue.$visible">Edit</a>
						</td>
					</tr>
					<tr>
						<th>Description</th>
						<td>
							<span 
								editable-textarea = "promotion.description" 
								e-rows = '4' 
								e-cols = '40' 
								e-form = 'description' 
								onbeforesave = 'updateDescription($data)'> 
								{{promotion.description}}
							</span>
						</td>
						<td>
							<a href="" ng-click="description.$show()" ng-hide="description.$visible">Edit</a>
						</td>
					</tr>
					<tr>
						<th>Start Date</th>
						<td>
							<span 
								id = 'promotion-startDate-edit'
								e-min-year = '2016'
								e-max-year = '2025'
								editable-combodate = 'promotion.startDate' 
								style = 'color:black; border-bottom:none;'
								onbeforesave = 'updateStartDate($data)'
								>
								{{ (promotion.startDate | date:'medium') || 'empty' }}
							</span>
						</td>
						<td>
							<a class = 'promotion-startDate-edit-button' href="">Edit</a>
						</td>
					</tr>
					<tr>
						<th>End Date</th>
						<td>
							<span 
								id = 'promotion-endDate-edit'
								e-min-year = '2016'
								e-max-year = '2025'
								editable-combodate = 'promotion.endDate' 
								style = 'color:black; border-bottom:none;'
								onbeforesave = 'updateEndDate($data)'
								>
								{{ (promotion.endDate | date:'medium') || 'empty' }}
							</span>
						</td>
						<td>
							<a class = 'promotion-endDate-edit-button' href="">Edit</a>
						</td>
					</tr>		
			</table>
		</div>
	</div>
	<div class = 'row'>
		<div class = 'col-md-8 col-md-offset-2'>
			<div class = "btn btn-danger" ui-sref = 'client({id: promotion.clientId})'>Back</div>
			<div class = "btn btn-default" ng-click = 'deletePromotion()'>Delete</div>
		</div>
	</div>
	<div class = 'row'>
		<div class = 'col-sm-8 col-sm-offset-2'>
			<h2>Users' Progress</h2>
			<div ng-repeat = 'user in matchingUsers'>
				<table class = 'table table-bordered'>
					<tr>
						<th>User</th>
						<td>{{user.firstName}} {{user.lastName}}</td>
					</tr>
					<tr>
						<th>Value</th>
						<td>
							<span id="percentage">{{user.progress.value}} / {{promotion.completionValue}}</span>
							<div class="progress">
							  <div class="progress-bar progress-bar-striped active" role="progressbar"
							  aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" ng-style="{width : (getPercentage(user.progress.value, promotion.completionValue) + '%' )}">
							  </div>
							</div>
						</td>
					</tr>
				</table>
			</div>

		</div>
	</div>
</div>